<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../layui/layui.all.js"></script>
    <script src="../layui/layui.js"></script>
    <link rel="stylesheet" href="../layui/css/layui.css">
    <style>
        .moveRight_top li {
            width: 60px;
            height: 60px;
            float: left;
            cursor: pointer;
            margin: 5px;
        }

        .moveRight_top, .moveRight_bottom {
            height: 70px;
            width: 100%;
            background-color: #fafafa;
            box-shadow: 5px 2px 6px #efefef inset;
        }

        .moveRight_top {
            height: 60px;
        }

        .moveRight_top li:hover {
            background-color: #ebebeb;
        }

        .moveRight_bottom {
            margin-top: 2px;
        }

        .moveRight_bottom li {
            float: left;
            cursor: pointer;
            margin-left: 5px;
        }
        .move_left{height: 40px;}
        .move_left li{
            height: 40px;
            line-height: 40px;
            margin-left: 30px;
        }
        .changeWidth2{width: 140px;}
        .moveRight_bottom_height{height: 38px;}
        .moveRight_bottom_height li{height: 38px;line-height: 38px;}
        #cheAddTop li{float: left;width: 220px;height: 40px;line-height: 40px;}
        #test16{width:120px;}
        #cheAddBottom{height: 500px;margin-top: 10px;width: 1010px;}
        .cheAddBottom_changeWidthAndHeight{float: left;width: 500px;height:100%;border: 1px solid black;}
        #cheAddBottom_top{padding: 10px 40px;}
        #panEidt,#panDelete,#panTui{border: 0;background-color: black;color: white; width: 40px;margin: 10px 20px}
        #checkAdd{display: none;}
    </style>
    <script src="../JQuery/jquery-3.4.1.min.js"></script>
</head>
<body>
<div class="layui-tab">
    <ul class="layui-tab-title">
        <li class="layui-this">盘点列表</li>
        <li>历史盘点查询</li>
        <li>未盘点查询</li>
    </ul>
    <div class="layui-tab-content">
        <div class="layui-tab-item layui-show">
            <div class="moveRight_top">
                <ul>
                    <li><i class="layui-icon layui-icon-file"
                           style="font-size: 30px;margin-left:15px;color: black;"></i><br/>
                        开始盘点
                    </li>
                    <li><i class="layui-icon layui-icon-search"
                           style="font-size: 30px;margin-left:15px;color: black;"></i><br/>
                        查看单据
                    </li>
                    <li>
                    <span style="display: inline-block;margin-left: 15px;"><i class="layui-icon layui-icon-close"
                                                                              style="font-size: 30px;color: red;"></i><br/>
                    退出</span></li>
                </ul>
            </div>
            <div class="moveRight_bottom move_left layui-input-inline " id="chooseOP">
                <ul>
                    <li id="addCheck"><i class="layui-icon layui-icon-add-circle-fine"
                           style="font-size: 20px;color: black;"></i>
                        新增盘点单
                    </li>
                    <li id="deleteCheck"><i class="layui-icon layui-icon-close" style="font-size: 20px; color: red;"></i>
                        删除盘点单
                    </li>
                    <li id="searchCheck">
                        <i class="layui-icon layui-icon-search" style="font-size: 20px; color: black;"></i>
                        高级查询
                    </li>
                </ul>
            </div>
            <div>
                <table class="layui-hide dataTable" id="pan"></table>
            </div>

            <div>
                <table class="layui-hide dataTable" id="panmingxi"></table>
            </div>
        </div>
        <div class="layui-tab-item">
            <div class="moveRight_top">
                <ul>
                    <li><i class="layui-icon layui-icon-search"
                           style="font-size: 30px;margin-left:15px;color: black;"></i><br/>
                        查看单据
                    </li>
                    <li>
                    <span style="display: inline-block;margin-left: 15px;"><i class="layui-icon layui-icon-templeate-1"
                                                                              style="font-size: 30px;color: black;"></i><br/>
                        打印</span>
                    </li>
                    <li>
                    <span style="display: inline-block;margin-left: 15px;"><i class="layui-icon layui-icon-upload-drag"
                                                                              style="font-size: 30px;color: black;"></i><br/>
                    导出</span></li>
                    <li>
                    <span style="display: inline-block;margin-left: 15px;"><i class="layui-icon layui-icon-close-fill"
                                                                              style="font-size: 30px;color: red;"></i><br/>
                    退出</span></li>
                </ul>
            </div>
            <div class="moveRight_bottom moveRight_bottom_height">
                <ul>
                    <li>
                        <div class="layui-inline">
                            查询日期：
                            <div class="layui-input-inline">
                                <input type="text" class="layui-input" id="beginTime" placeholder="yyyy-MM-dd HH:mm:ss">
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="layui-inline">
                            至
                            <div class="layui-input-inline">
                                <input type="text" class="layui-input" id="endTime"  placeholder="yyyy-MM-dd HH:mm:ss">
                            </div>
                        </div>
                    </li>
                    <li>
                        仓库名称:
                        <select name="orgType" lay-filter="Type_filter" id="ware" lay-verify="required">
                            <option value="">请选择</option>
                        </select>
                    </li>
                    <li>
                        操作员：
                    </li>
                    <li>
                        <button type="button" class="layui-btn layui-btn-radius layui-btn-normal" style="background-color: black;width: 100px;">查询</button>
                    </li>
                </ul>
            </div>
            <div>
                <table class="layui-hide dataTable" id="historyPan"></table>
            </div>
        </div>
        <div class="layui-tab-item">
            <div class="moveRight_top">
                <ul>
                    <li>
                        <span style="display: inline-block;margin-left: 15px;"><i class="layui-icon layui-icon-file"
                                                                                  style="font-size: 30px;"></i><br/>
                    打印</span>

                    </li>
                    <li>
                        <span style="display: inline-block;margin-left: 15px;"><i class="layui-icon layui-icon-upload"
                                                                                  style="font-size: 30px;"></i><br/>
                    导出</span>

                    </li>
                    <li>
                    <span style="display: inline-block;margin-left: 15px;"><i class="layui-icon layui-icon-close"
                                                                              style="font-size: 30px;color: red;"></i><br/>
                    退出</span></li>
                </ul>
            </div>
            <div class="moveRight_bottom moveRight_bottom_height">
                <ul>
                    <li class="layui-form">选择仓库<select name="orgType" lay-filter="Type_filter" id="wareHoseName" lay-verify="required">
                        <option value="">请选择</option>
                    </select>
                    </li>
                    <li>商品类别：<select name="orgType" lay-filter="Type_filter" id="productTypeName" lay-verify="required">
                        <option value="">请选择</option></select>
                    </li>
                    <li>
                        商品名称或编号
                        <div class="layui-input-inline">
                            <input type="text" name="title" required lay-verify="required" autocomplete="off" class="layui-input">
                        </div>
                    </li>
                    <li>
                        <button type="button" class="layui-btn layui-btn-radius layui-btn-normal" style="background-color: black;width: 100px;">查询</button>
                    </li>
                </ul>

            </div>
            <div>
                <table class="layui-hide dataTable" id="weiPan"></table>
            </div>
        </div>
    </div>
</div>
<div id="checkAdd">
    <div id="cheAddTop">
        <div>
            <ul>
                <li>盘点单号：<span id="panOdd"></span></li>
                <li class=" layui-form">盘点仓库：
                    <div class="layui-input-inline changeWidth2">
                        <select name="orgType" lay-filter="Type_filter" id="wareHose" lay-verify="required">
                        </select>
                    </div>
                </li>
                <li>盘点日期：
                    <div class="layui-input-inline">
                        <input type="text" class="layui-input changeWidth" id="test16" readonly/>
                    </div>
                </li>
                <li>操作员：
                <span></span>
                </li>
            </ul>
            <div class="layui-input-inline">
                备注：<input type="text" style="border-bottom: 1px solid black;border-top: 0;border-left:0;border-right: 0; width: 600px;">
            </div><br/>
            <span style="color: red;">提示：盘点前选择仓库，盘点中不能更换仓库和日期。在没有修正仓库之前请勿有采购进货、销售等能改变库存数量的操作，不然会造成库存数量不准。</span>
        </div>
    </div>
    <div id="cheAddBottom">
        <div class="cheAddBottom_changeWidthAndHeight">
            <h4>库存商品</h4>
            <div id="cheAddBottom_top">
                商品信息：
                <input type="text"/>
                <input type="button" value="查询" style="background-color: black;color:white;border: 0;width: 50px;cursor: pointer;" >
            </div>
            <div>
                        <div class="layui-tab-item layui-show">
                            <table class="layui-hide dataTable" id="productInfo"></table>
                        </div>
            </div>
        </div>
        <div class="cheAddBottom_changeWidthAndHeight">
            <h4>已盘点商品</h4>
            <div>
                <input type="button" id="panEidt" style="border: 0;background-color: black;color: white; width: 40px;margin: 0 20px;cursor: pointer" value="修改">
                <input type="button" id="panDelete" style="border: 0;background-color: black;color: white; width: 40px;margin: 0 20px;cursor: pointer" value="删除">
                <input type="button" id="panTui" style="border: 0;background-color: black;color: white; width: 40px;margin: 0 20px;cursor: pointer" value="退出">
            </div>
            <div>
                <table class="layui-hide dataTable" id="alreadyPan"></table>
            </div>
        </div>
    </div>
</div>
<script>
    layui.use(['table','laydate','form'], function () {
        var table = layui.table, laydate = layui.laydate,$=layui.$;
        var form= layui.form;
        //
        laydate.render({
            elem: '#test16'
            , type: 'datetime'
            , format: 'yyyy-M-d'
        });
        //自动获取仓库的下拉框
        $.ajax({
            url: '/wareHouseManager/searchWareHourseInfo.action',
            dataType: 'json',
            data: {'state': 0},	//查询状态为正常的所有机构类型
            type: 'post',
            success: function (data) {
                var count=0;
                $.each(data, function (index, item) {
                    count++;
                    $('#wareHoseName').append(new Option(item.warName, item.warID));// 下拉菜单里添加元素
                    if(count==1){
                        $('#wareHoseName').val("WH00001");
                    }
                });
                layui.form.render("select");
            }
        });

        //生成盘点单号
        $.ajax({
            url: '/wareHouseManager/seachCheckOdd.action',
            type: 'post',
            success: function (data) {
                $('#panOdd').text(data);
                $('#panOdd').css({"color":"red"});
            }
        });

        //盘点列表中的主表
        table.render({
            elem: '#pan'
            , url: '/demo/table/user/'
            , cellMinWidth: 80 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
            , cols: [[
                {field: 'id', width: 80, title: '盘点单号', sort: true}
                , {field: 'username', width: 80, title: '日期', sort: true}
                , {field: 'sex', width: 150, title: '仓库名称', sort: true}
                , {field: 'city', width: 100, title: '操作员', sort: true}
                , {field: 'sign', width: 100, title: '商品条数', sort: true, totalRow: true} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                , {field: 'experience', width: 100, title: '商品数量', sort: true, totalRow: true}
                , {field: 'score', title: '备注', sort: true}
            ]]
            , page: true
            , height: 230
            , totalRow: true
        });
        //盘点列表中的子表
        table.render({
            elem: '#panmingxi'
            , url: '/demo/table/user/'
            , cellMinWidth: 80 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
            , totalRow: true
            , cols: [[
                {field: 'id', width: 80, title: '盘点单号', sort: true}
                , {field: 'username', width: 80, title: '日期', sort: true}
                , {field: 'sex', width: 150, title: '仓库名称', sort: true}
                , {field: 'city', width: 100, title: '操作员', sort: true}
                , {field: 'sign', width: 100, title: '商品条数', sort: true, totalRow: true} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                , {field: 'experience', width: 100, title: '商品数量', sort: true, totalRow: true}
                , {field: 'score', title: '备注', sort: true}
            ]]
            , page: true
            , height: 230
        });
        //historyPan历史盘点
        table.render({
            elem: '#historyPan'
            , url: '/demo/table/user/'
            , cellMinWidth: 80 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
            , totalRow: true
            , cols: [[
                {field: 'id', width: 80, title: '盘点单号', sort: true}
                , {field: 'username', width: 80, title: '盘点日期', sort: true}
                , {field: 'sex', width: 150, title: '商品编号', sort: true}
                , {field: 'city', width: 100, title: '商品名称', sort: true}
                , {field: 'sign', width: 100, title: '商品批号', sort: true, totalRow: true} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                , {field: 'experience', width: 100, title: '有效期', sort: true, totalRow: true}
                , {field: 'score', width: 80, title: '单位', sort: true}
                , {field: 'score', width: 100, title: '规格型号', sort: true}
                , {field: 'score', width: 100, title: '盘点数量', sort: true}
                , {field: 'score', width: 100, title: '库存数量', sort: true}
                , {field: 'score', width: 100, title: '数量差值', sort: true}
                , {field: 'score', width: 100, title: '金额差值', sort: true}
                , {field: 'score', width: 100, title: '仓库名称', sort: true}

            ]]
            , page: true
            , height:450
        });
        //未盘点的数据
        table.render({
            elem: '#weiPan'
            , url: '/demo/table/user/'
            , cellMinWidth: 80 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
            , totalRow: true
            , cols: [[
                {field: 'sex', width: 150, title: '商品编号', sort: true}
                , {field: 'city', width: 100, title: '商品名称', sort: true}
                , {field: 'city', width: 100, title: '商品类别', sort: true}
                , {field: 'sign', width: 80, title: '数量', sort: true, totalRow: true} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                , {field: 'score', width: 80, title: '单位', sort: true}
                , {field: 'score', width: 100, title: '产品规格', sort: true}
                , {field: 'score', width: 80, title: '批号', sort: true}
                , {field: 'score', width: 100, title: '有效期', sort: true}
                , {field: 'score', width: 100, title: '生产厂商', sort: true}
                , {field: 'score', width: 100, title: '所在仓库', sort: true}
                , {field: 'score', width: 100, title: '备注', sort: true}
            ]]
            , page: true
            , height:450
        });
        //productInfo
        table.render({
            elem: '#productInfo'
            , url: '/demo/table/user/'
            , cols: [[
                {field: 'sex', width: 100, title: '商品编号', sort: true}
                , {field: 'city', width: 100, title: '商品名称', sort: true}
                , {field: 'city', width: 80, title: '单位', sort: true}
                , {field: 'sign', width: 100, title: '规格型号', sort: true} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                , {field: 'score', width: 100, title: '库存数量', sort: true}
            ]]
            , page: true
            , height:300
            , widht:500
        });
        //productList
        table.render({
            elem: '#alreadyPan'
            , url: '/demo/table/user/'
            , cols: [[
                {field: 'sex', width: 100, title: '商品编号', sort: true}
                , {field: 'city', width: 100, title: '商品名称', sort: true}
                , {field: 'city', width: 100, title: '盘点单号', sort: true}
                , {field: 'sign', width: 100, title: '库存数量', sort: true} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                , {field: 'score', width: 100, title: '盘点数量', sort: true}
            ]]
            , page: true
            , height:300
            , widht:520
        });
        //日期时间选择器
        laydate.render({
            elem: '#beginTime'
            ,type: 'datetime'
            , value: new Date()
        });
        laydate.render({
            elem: '#endTime'
            ,type: 'datetime'
            , value: new Date()
        });

        var index;
        $('#chooseOP li').click(function(){
            var idValue = $(this).attr('id');
            if(idValue=='addCheck'){//增加盘点单
                index=layer.open({
                    type: 1
                    , title: ['录入盘点商品', 'font-size:13px;', 'background-color:black;']
                    , content:$('#checkAdd') //这里content是一个普通的String
                    , area: ['1000px', '500px']
                });
                //自动获取仓库的下拉框
                $.ajax({
                    url: '/wareHouseManager/searchWareHourseInfo.action',
                    dataType: 'json',
                    data: {'state': 0},	//查询状态为正常的所有机构类型
                    type: 'post',
                    success: function (data) {
                        var count=0;
                        $.each(data.data, function (index, item) {
                            $('#wareHose').append(new Option(item.warName, item.warID));// 下拉菜单里添加元素
                            if(count==1){
                                $('#wareHose').val("WH00001");
                            }
                        });
                        form.render("select");
                    }
                });
            }else if(idValue=='deleteCheck'){
                window.alert("delete");
            }else{
                window.alert("search");
            }
        });
        $('#panTui').click(function(){
            layer.close(index);
        });
    });
</script>
</body>
</html>